"use strict";angular.module("bricksApp.common",["bricksApp.apps"]),angular.module("bricksApp.common").directive("navbar",["$location","$parse",function(a,b){return{replace:!0,restrict:"E",templateUrl:"scripts/common/navbar.html",link:function(c,d,e){var f=b(e.hideOn)(c);Array.isArray(f)||(f=[f]),c.show=-1===f.indexOf(a.path()),c.$watch(function(){return a.path()},function(a,b){a!==b&&(c.show=-1===f.indexOf(a))})}}}]),angular.module("bricksApp.common").directive("activelink",["$location",function(a){return{restrict:"A",link:function(b,c,d){var e=d.activelink,f=c.find("a")[0].hash.substring(1);b.$location=a,b.$watch("$location.path()",function(a){f.length>1&&a.substr(0,f.length)===f||a.split("/")[1]===f.substr(1,f.length)||1===f.length&&1===a.length?c.addClass(e):c.removeClass(e)})}}}]),angular.module("bricksApp.common").directive("modal",function(){return{replace:!0,restrict:"E",scope:{closeable:"&",close:"&",open:"&",submit:"&",title:"="},templateUrl:"scripts/common/modal.html",transclude:!0,link:function(a){a.closeable=a.closeable(),void 0===a.closeable&&(a.closeable=!0)}}}),angular.module("bricksApp.common").directive("validationClass",function(){return{require:"ngModel",restrict:"A",scope:{form:"@"},link:function(a,b,c){var d=b.controller("form"),e=b.parent().parent();a.$watch(c.ngModel,function(){var a=b[0].name;d[a].$dirty&&(d[a].$invalid?e.removeClass("has-success").addClass("has-error"):e.removeClass("has-error").addClass("has-success"))})}}}),angular.module("bricksApp.about",["ngRoute"]).config(["$routeProvider",function(a){a.when("/about",{templateUrl:"scripts/about/about.html"})}]),angular.module("bricksApp.apps",[]).service("apps",["$window",function(a){var b="bricks_apps",c="bricks_current",d=a.localStorage.getItem(b),e=a.localStorage.getItem(c);return d=d?angular.fromJson(d):[],{all:function(){return angular.copy(d)},current:function(b){if(!b){var f;return e=a.localStorage.getItem(c),d.forEach(function(a){a.id===e&&(f=a)}),f?f:d[0]}e=b.id,a.localStorage.setItem(c,e)},add:function(c){c.id=c.id||uuid(),c.css=c.css||"",c.js=c.js||"",c.pages=c.pages||[{url:"/",template:""}],c.storage=c.storage||"local",c.tables=c.tables||[],d.push(angular.copy(c)),a.localStorage.setItem(b,angular.toJson(d))},update:function(c){d.forEach(function(e,f){e.id===c.id&&(d[f]=angular.copy(c),a.localStorage.setItem(b,angular.toJson(d)))})},remove:function(c){d.forEach(function(e,f){e.id===c&&(d.splice(f,1),a.localStorage.setItem(b,angular.toJson(d)))})}}}]).directive("apps",["$document","$http","apps",function(a,b,c){var d=function(a){var b={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},c=/\\|'|\r|\n|\t|\u2028|\u2029/g;return a.replace(c,function(a){return"\\"+b[a]})};return{replace:!0,restrict:"E",templateUrl:"scripts/apps/apps.html",link:function(e){e.showAppsMenu=!1,e.showAppsModal=!1,e.app={},e.$watch(function(){return c.all()},function(){e.apps=c.all(),e.currentApp=c.current()},!0),e.addApp=function(){var b=angular.element(a[0].newAppForm);b.controller("form").$valid&&(e.apps.push(e.app),c.add(e.app),c.current(e.app),e.currentApp=e.app,e.app={},e.showAppsModal=!1)},e.selectApp=function(a){c.current(a),e.currentApp=a,e.showAppsMenu=!1},e.toggleAppsMenu=function(){e.showAppsMenu=!e.showAppsMenu},e.toggleAppsModal=function(){e.showAppsModal=!e.showAppsModal,e.showAppsMenu=!1},e.hideAppsModal=function(){e.showAppsModal=!1},e.download=function(){var a=new JSZip,c=a.folder(e.currentApp.name);b.get("build.html",{cache:!0}).then(function(a){var f="<script>window.bricksApp = JSON.parse('"+d(angular.toJson(e.currentApp))+"');</script>",g=a.data.replace("</head>",f+"\n</head>");return c.file("index.html",g),b.get("bower_components/node-uuid/uuid.js",{cache:!0})}).then(function(a){return e.scripts=a.data,b.get("scripts/storage/storage.js",{cache:!0})}).then(function(a){return e.scripts+=a.data,b.get("scripts/preview.js",{cache:!0})}).then(function(b){c.folder("scripts").file("build.js",e.scripts+b.data),saveAs(a.generate({type:"blob"}),e.currentApp.name+".zip")})}}}}]),angular.module("bricksApp.database",["ngRoute","bricksApp.common"]).config(["$routeProvider",function(a){a.when("/database",{templateUrl:"scripts/database/database.html",controller:"DatabaseCtrl"})}]).controller("DatabaseCtrl",["$scope","$window","apps","storage",function(a,b,c,d){var e,f=[{field:"actions",displayName:"",enableCellEdit:!1,pinnable:!1,width:24,cellTemplate:'<div class="ngCellText" ng-class="col.colIndex()"><a href="" ng-click="deleteRow(row.entity)"><span class="fa fa-trash-o text-danger"></span></a></div>'}];a.showMenu={actions:!1},a.defaultColumns=[{name:"id"},{name:"created_at"},{name:"updated_at"}],a.app=c.current(),a.selectTable=function(b){a.currentTable=a.app.tables[b],a.currentIndex=b,a.currentTable&&(a.data=e.all(a.currentTable.name))},d.init(a.app).then(function(b){e=b,a.app.tables&&a.selectTable(0)}),a.gridOptions={columnDefs:"columns",data:"data",enableCellEditOnFocus:!0,enableCellSelection:!0,enablePaging:!0,enablePinning:!0,enableRowSelection:!1,showFooter:!0},a.showModal={newTable:!1,newColumn:!1},a.newTable={},a.newColumn={},a.newRow={},a.columnToDelete={},a.$watch(function(){return a.currentTable&&a.currentTable.name?e.all(a.currentTable.name):void 0},function(b){a.data=b}),a.$watch(function(){return c.current().id},function(b){a.app.id!==b&&(a.app=c.current(),d.init(a.app).then(function(b){e=b,a.app.tables?a.selectTable(0):a.app.tables=[]}))}),a.$watch("currentTable.columns",function(b){b&&(a.columns=b.reduce(function(a,b){return a.push({field:b.name}),a},angular.copy(f)))},!0),a.hasTables=function(){return a.app.tables&&a.app.tables.length>0},a.isDefaultColumn=function(b){var c=!1;return a.defaultColumns.forEach(function(a){a.name===b.name&&(c=!0)}),c},a.addTable=function(){var b=angular.element(document.newTableForm);if(b.controller("form").$valid){a.newTable.columns=angular.copy(a.defaultColumns);var d=a.app.tables.push(angular.copy(a.newTable))-1;c.update(a.app),a.selectTable(d),a.newTable={},a.showModal.newTable=!1}},a.deleteTable=function(){var d=b.confirm('Are you sure you want to delete the table "'+a.currentTable.name+'"?');d&&(a.app.tables.splice(a.currentIndex,1),c.update(a.app),a.selectTable(0)),a.showMenu.actions=!1},a.addColumn=function(){var b=angular.element(document.newColumnForm);b.controller("form").$valid&&(a.currentTable.columns.push(angular.copy(a.newColumn)),c.update(a.app),a.newColumn={},a.showModal.newColumn=!1)},a.deleteColumn=function(){var d=a.currentTable.columns[a.columnToDelete],e=b.confirm('Are you sure you want to delete the column "'+d.name+'"?');e&&(a.currentTable.columns.splice(a.columnToDelete,1),c.update(a.app),a.showModal.deleteColumn=!1)},a.addRow=function(){e.add(a.currentTable.name,a.newRow),a.newRow={},a.showModal.newRow=!1},a.deleteRow=function(b){e.remove(a.currentTable.name,b)},a.emptyTable=function(){var c='Are you sure you want to delete all the rows in the table "'+a.currentTable.name+'"?';b.confirm(c)&&e.clear(a.currentTable.name),a.showMenu.actions=!1}}]),angular.module("bricksApp.settings",["ngRoute","bricksApp.common"]).config(["$routeProvider",function(a){a.when("/settings",{templateUrl:"scripts/settings/settings.html",controller:"SettingsCtrl"})}]).controller("SettingsCtrl",["$location","$scope","$window","apps",function(a,b,c,d){b.alerts=[],b.app=angular.copy(d.current()),b.storages=[{name:"local",label:"User's Device"},{name:"firebase",label:"Firebase"}],b.$watch(function(){return d.current()},function(a){b.app=angular.copy(a)},!0),b.saveSettings=function(){b.settingsForm.$valid&&(d.update(b.app),b.alerts.push({type:"success",message:"Settings saved."}))},b.deleteApp=function(b){var e=c.confirm('Are you sure you want to delete the app "'+b.name+"\"? There's no going back.");e&&(d.remove(b.id),a.path("/"))}}]),angular.module("bricksApp.start",["ngRoute","bricksApp.common"]).config(["$routeProvider",function(a){a.when("/start",{templateUrl:"scripts/start/start.html",controller:"StartCtrl"})}]).run(["apps","$location","$rootScope",function(a,b,c){c.$on("$locationChangeStart",function(c,d){0===a.all().length&&-1===d.indexOf("/start")&&b.path("/start")})}]).controller("StartCtrl",["$location","$scope","apps",function(a,b,c){c.all().length>0&&a.path("/").replace(),b.app={},b.addApp=function(){b.newAppForm.$valid&&(c.add(b.app),c.current(b.app),a.path("/").replace())}}]),angular.module("bricksApp.storage",["firebase"]).factory("localData",["$q","$window",function(a,b){var c,d={},e=function(a){var d=b.localStorage.getItem(c+a);return d?angular.fromJson(d):[]},f=function(a){var e=d[a]?angular.toJson(d[a]):"";b.localStorage.setItem(c+a,e)};return function(b,g){var h=a.defer();return d=g.data,c="bricks_app_"+b.id+"_",b.tables.forEach(function(a){g.data[a.name]=e(a.name),g.$watch("data."+a.name,function(){f(a.name)},!0)}),h.resolve(),h.promise}}]).factory("firebaseData",["$rootScope","angularFire",function(a,b){return function(a,c){return b(new Firebase("https://"+a.settings.firebase+".firebaseio.com"),c,"data")}}]).service("storage",["$q","$rootScope","firebaseData","localData",function(a,b,c,d){var e=b.$new();return e.init=function(a){var b;return e.data={},b="firebase"===a.storage?c(a,e):d(a,e),b.then(function(){return e})},e.all=function(a){return a?e.data[a]:e.data},e.get=function(a,b){var c;return e.data[a]&&e.data[a].some(function(a){return a.id===b?(c=a,!0):void 0}),c},e.add=function(a,b){var c=(new Date).toISOString().split(".")[0].replace("T"," ");b.id=uuid(),b.created_at=c,b.updated_at=c,e.data[a]=e.data[a]||[],e.data[a].push(b)},e.update=function(a,b){e.data[a]&&e.data[a].some(function(c,d){return c.id===b.id?(e.data[a][d]=b,!0):void 0})},e.remove=function(a,b){e.data[a]&&e.data[a].some(function(c,d){return c.id===b.id?(e.data[a].splice(d,1),!0):void 0})},e.clear=function(a){e.data[a].length=0},e}]),angular.module("bricksApp.ui",["ngRoute","bricksApp.common"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"scripts/ui/ui.html"})}]).directive("ui",["components","apps",function(a,b){return{controller:["$scope","$element",function(a,c){var d,e,f=c.find("iframe"),g=b.current().pages[0],h=function(){e||(e=f.contents().find("div[ng-view]")),g.template=html_beautify(e.html())},i=function(b){b.is("html, body, [ng-view]")||(d=b,a.$broadcast("selection"))},j=function(b){return b?(d=b,a.$broadcast("selection"),void 0):d},k=function(a){return a?(a.template=html_beautify(a.template),g=a,void 0):g};return{iframe:f,updateTemplate:h,selectElement:i,selection:j,page:k}}],link:function(b){b.components=a.all()}}}]).service("components",["$http",function(a){var b=[];return a.get("scripts/ui/components/components.html",{cache:!0}).success(function(a){jQuery(a).find("component").each(function(a,c){var d={};[].forEach.call(c.children,function(a){d[a.nodeName.toLowerCase()]=a.innerHTML.trim()}),b.push(d)})}),{all:function(){return b}}}]),angular.module("bricksApp.ui").directive("componentStyle",["$compile","$timeout","components",function($compile,$timeout,components){return{replace:!0,require:"^ui",restrict:"E",scope:{},templateUrl:"scripts/ui/components/component-style.html",link:function(scope,element,attrs,uiCtrl){var form=element.find("form"),allComponents=components.all();scope.component={},scope.options={},scope.update=function(){},scope.select=uiCtrl.selection,scope.change=function(){scope.update(),uiCtrl.updateTemplate()},scope.$on("selection",function(){scope.options={},scope.component={},form.empty(),allComponents.some(function(a){var b;return scope.selection=uiCtrl.selection(),b=scope.selection.is(a.selector),b&&(scope.component=a),b}),scope.component["admin-script"]&&eval(scope.component["admin-script"]),scope.component.admin&&form.append($compile(scope.component.admin)(scope)),$timeout(function(){scope.$apply()})})}}}]),angular.module("bricksApp.ui").directive("bindings",["$timeout","apps",function(a,b){return{replace:!0,require:"^ui",restrict:"E",scope:{},templateUrl:"scripts/ui/components/bindings.html",link:function(c,d,e,f){c.selection=null,c.tables=b.current().tables,c.bindings={};var g=function(a){var b=[];return angular.isString(a)&&(a=a.trim(),"{"===a.charAt(0)&&"}"===a.slice("-1")&&a.slice(1,-1).split(",").forEach(function(a){a=a.split(":"),b.push({name:a[0].trim().slice(1,-1),value:a[1].trim()})})),b},h=function(a){var b=[];return a.forEach(function(a){a=a.split(":"),"filter"===a.shift().trim()&&a.length>0&&(a=g(a.join(":")),b=b.concat(a))}),b},i=function(a){if(!a)return{};var b,d;return a=a.split("|"),b=a?a.shift().trim().split(" "):[],3!==b.length?{}:(c.tables.some(function(a){return a.name===b[0]?(d=a.name,!0):void 0}),{table:d,filters:h(a)})},j=function(a,b){var c=[];b.classes.forEach(function(a){a.name&&a.value&&c.push("'"+a.name+"': "+a.value)}),c.length>0?a.attr("ng-class","{"+c.join(", ")+"}"):a.removeAttr("ng-class")},k=function(a){var b=[];return a.filters.length>0&&(a.filters.forEach(function(a){var c,d;(a.name||a.value)&&(c=a.name?a.name:"$",d=a.value?a.value:"true",b.push("'"+c+"': "+d))}),b.length>0)?"filter:{"+b.join(", ")+"}":""},l=function(a,b){if(!b.repeat)return a.removeAttr("ng-repeat"),void 0;var c=b.repeat+" in data['"+b.repeat+"']",d=k(b);d&&(c+=" | "+d),a.attr("ng-repeat",c)};c.$watch("bindings",function(a){c.selection&&c.tables&&(a.bind?c.selection.attr("ng-bind",a.bind):c.selection.removeAttr("ng-bind"),a.model?c.selection.attr("ng-model",a.model):c.selection.removeAttr("ng-model"),j(c.selection,a),l(c.selection,a),f.updateTemplate())},!0),c.$on("selection",function(){c.selection=f.selection(),c.nodeName=c.selection.prop("nodeName"),c.isInput=["INPUT","TEXTAREA","SELECT"].indexOf(c.nodeName)>-1;var b=i(c.selection.attr("ng-repeat"));c.bindings={bind:c.selection.attr("ng-bind"),model:c.selection.attr("ng-model"),repeat:b.table,filters:b.filters||[],classes:g(c.selection.attr("ng-class"))},a(function(){c.$apply()})})}}}]),angular.module("bricksApp.ui").directive("draggable",function(){return function(a,b,c){b.on("dragstart",function(b){var d=a.$eval(c.html);b.originalEvent.dataTransfer.effectAllowed="move",b.originalEvent.dataTransfer.setData("text/plain",d)})}}),angular.module("bricksApp.ui").directive("droppable",function(){return{require:"^ui",link:function(a,b,c,d){var e,f,g,h,i=b,j=function(a){var b=angular.element(a.target);b.is("html, body, div[ng-view]")||(e=a.target.draggable,a.target.draggable=!0,b.on("dragstart",function(a){a.originalEvent.dataTransfer.effectAllowed="move",f=angular.element(a.target)}))},k=function(a){e||a.target.removeAttribute("draggable")},l=function(a,b){b=angular.element(b),b.is("html, body")&&(b=h),b.is("div[ng-view], :empty:not(input, textarea)")?b.append(a):b.after(a)},m=function(a,b){var c;b=angular.element(b),angular.isElement(a)?c=a.parent():a=angular.element(a),l(a,b),c&&c.html(c.html().trim())},n=function(a){a.preventDefault(),a.originalEvent.dataTransfer.dropEffect="move",g=angular.element(a.target),g.addClass("bricks-dragover")},o=function(){g.removeClass("bricks-dragover")},p=function(b){var c;return b.stopPropagation(),f?(f[0].removeAttribute("draggable"),c=f,f=null):c=b.originalEvent.dataTransfer.getData("text/plain"),g.removeClass("bricks-dragover"),m(c,b.target),d.updateTemplate(),a.$apply(),!1};i.on("load",function(){var a=i.contents();h=a.find("div[ng-view]"),a.on({dragover:n,dragleave:o,drop:p,mousedown:j,mouseup:k})})}}}),angular.module("bricksApp.ui").directive("editFrame",["$http",function(){return{require:"^ui",link:function(a,b,c,d){var e,f=b,g=function(a){a.preventDefault(),d.selectElement(angular.element(a.target))};a.$watch(function(){return d.page().template},function(a){e&&a!==html_beautify(e.html())&&e.html(a)}),f.on("load",function(){var a=f.contents();e=a.find("div[ng-view]"),e.html(d.page().template),a.on("click",g)})}}}]),angular.module("bricksApp.ui").directive("events",["$timeout","apps",function(a,b){return{replace:!0,require:"^ui",restrict:"E",scope:{},templateUrl:"scripts/ui/components/events.html",link:function(c,d,e,f){c.selection=null,c.app=b.current(),c.event={},c.names="blur change click copy cut dblclick focus keydown keyup keypress mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup paste submit".split(" "),c.actions={add:"add row",update:"update row",remove:"remove row",visit:"load page",custom:"custom"};var g=function(a,b){var d=a.attr("ng-"+b);if(d)if(c.event.type=b,c.event.action=d.split("(")[0],c.event.action&&Object.keys(c.actions).indexOf(c.event.action)>-1){var e=d.split("'")[1];c.event.object="visit"===c.event.action?e.replace(/{{(\w+)\.id}}/,":$1"):e}else c.event.action="custom",c.event.object=d};c.$on("selection",function(){c.selection=f.selection(),c.event={},c.names.forEach(function(a){g(c.selection,a)}),a(function(){c.$apply()})}),c.$watch("event",function(a){var b;if(c.selection){if(a.type&&a.action&&a.object){switch(a.action){case"custom":b=a.object;break;case"visit":var d=a.object.replace(/:(\w+)/,"{{$1.id}}");b=a.action+"('"+d+"')";break;default:b=a.action+"('"+a.object+"', "+a.object+")"}c.selection.attr("ng-"+a.type,b)}else c.selection.removeAttr("ng-"+a.type);f.updateTemplate()}},!0)}}}]),angular.module("bricksApp.ui").factory("Overlay",function(){var a=function(a,b){var c=this.iframe=angular.element("iframe[edit-frame]");this.element=a,c.on("load",function(){c.contents().on(b)})};return a.prototype.moveTo=function(a){if(0!==a.closest("div[ng-view]").length){var b=this.iframe[0].contentWindow,c=this.iframe[0].offsetTop-b.pageYOffset,d=this.iframe[0].offsetLeft-b.pageXOffset,e=a.offset();return this.element.css({display:"block",width:a.outerWidth()+"px",height:a.outerHeight()+"px",top:c+e.top+"px",left:d+e.left+"px"})}},a}).directive("overlayHighlight",["Overlay",function(a){return{replace:!0,require:"^ui",restrict:"E",template:'<div class="overlay-highlight"></div>',link:function(b,c){var d=new a(c,{"click mouseout":function(){c.hide()},mouseover:function(a){d.moveTo(angular.element(a.target))}})}}}]).directive("overlaySelect",["Overlay",function(a){return{replace:!0,require:"^ui",restrict:"E",template:'<div class="overlay-select"><div class="actions"><span>{{selector}}</span><a href="" title="Select parent" ng-click="parent($event)"><span class="fa fa-level-up"></span></a><a href="" title="Duplicate" ng-click="copy($event)"><span class="fa fa-copy"></span></a><a href="" title="Delete" ng-click="delete($event)"><span class="fa fa-trash-o"></span></a></div></div>',link:function(b,c,d,e){var f=new a(c,{click:function(a){if(c.is(":visible")&&b.selected[0]===a.target)c.hide(),b.selected=null;else{var d=angular.element(a.target);f.moveTo(d)&&(b.selected=d)}}}),g=function(a){var c=a.attr("id");if(c)b.selector="#"+c;else{var d=a.attr("class"),e=a.prop("tagName").toLowerCase();b.selector=d?e+"."+d.split(/\s+/).join("."):e}};b.parent=function(a){a.preventDefault();var c=b.selected.parent();c.is("div[ng-view]")||(b.selected=c)},b.copy=function(a){a.preventDefault(),b.selected=b.selected.clone().insertAfter(b.selected),e.updateTemplate()},b.delete=function(a){var d=b.selected.parent();if(a.preventDefault(),b.selected.remove(),d){var f=d.html();f=f?d.html().trim():"",d.html(f)}e.updateTemplate(),c.hide()},b.$watch("selected",function(a){a&&(f.moveTo(a),g(a),e.selectElement(b.selected))}),b.$watch(function(){return e.page()},function(){c.hide()})}}}]),angular.module("bricksApp.ui").directive("pages",["$timeout","$window","apps",function(a,b,c){return{replace:!0,require:"^ui",restrict:"E",templateUrl:"scripts/ui/pages/pages.html",link:function(d,e,f,g){var h=!1;d.newPage={template:""},d.showModal=!1,d.savePageText="Save",d.current={},d.setCurrent=function(a){d.current=a,g.page(a),d.showMenu=!1},d.$watch(function(){return c.current().id},function(){d.app=c.current(),d.setCurrent(d.app.pages[0])}),d.$watch(function(){return g.page().template},function(a,b){a!==b&&(h=!0)}),b.addEventListener("beforeunload",function(a){if(h){var c="You have unsaved changes on this page. If you leave without saving your changes will be lost.";return(a||b.event).returnValue=c,c}}),d.addPage=function(){var a=angular.copy(d.newPage);d.app.pages.push(a),c.update(d.app),d.setCurrent(a),d.newPage={template:""},d.showModal=!1},d.savePage=function(){c.update(d.app),h=!1,d.savePageText="Saving...",a(function(){d.savePageText="Save"},1e3)},d.deletePage=function(){b.confirm("Are you sure you want to delete this page?")&&(d.app.pages.some(function(a,b){return d.current.url===a.url?(d.app.pages.splice(b,1),!0):void 0}),c.update(d.app),d.setCurrent(d.app.pages[0]))}}}}]),angular.module("bricksApp.ui").directive("preview",["$http","$location","$window","apps",function(a,b,c,d){return{replace:!0,require:"^ui",restrict:"E",template:'<button class="preview" ng-click="preview()">Preview</button>',link:function(a){angular.element("#canvas");var e=null;a.preview=function(){e&&!e.closed&&e.close(),e=c.open("preview.html"),angular.element(e).on("load",function(){e.postMessage(d.current(),b.absUrl())})},a.$on("$destroy",function(){e&&e.close()})}}}]),angular.module("bricksApp.ui").directive("inspector",["apps",function(a){return{replace:!0,require:"^ui",restrict:"E",templateUrl:"scripts/ui/pages/inspector.html",link:function(b,c,d,e){var f,g=angular.element("iframe[edit-frame]"),h={lineWrapping:!0,lineNumbers:!0,theme:"base16-dark"};b.page=e.page,b.view="html",b.app=a.current(),b.htmlOptions=angular.extend({mode:{name:"xml",htmlMode:!0}},h),b.cssOptions=angular.extend({mode:"css"},h),b.jsOptions=angular.extend({mode:"javascript"},h),g.on("load",function(){f||(f=g.contents().find("#bricksAppStyle")),f.html(b.app.css)}),b.$watch("app.css",function(a){f&&f.html(a)})}}}]),angular.module("bricksApp.ui").directive("devices",function(){return{restrict:"E",templateUrl:"scripts/ui/screen/devices.html",link:function(a){var b=angular.element("#canvas").find("iframe");a.devices=["mobile","tablet","laptop","desktop","expand"],a.currentDevice="expand",a.$watch("currentDevice",function(a,c){b.removeClass("device-"+c).addClass("device-"+a)})}}}),angular.module("bricksApp.ui").directive("inspectorToggle",function(){return{replace:!0,restrict:"E",template:'<button class="btn btn-link" ng-click="toggleInspector()"><span class="fa fa-code"></span></button>',link:function(a){var b=angular.element("body"),c=!1;a.toggleInspector=function(){c=!c,c?b.addClass("inspector-visible"):b.removeClass("inspector-visible")}}}}),angular.module("bricksApp.ui").directive("sidebarToggle",["$animate",function(a){return{replace:!0,restrict:"E",scope:{},template:'<button class="collapse-button" ng-click="toggleSidebar()"></button>',link:function(b,c,d){var e=angular.element("body"),f="collapsed-"+d.position,g="collapse-button-parent "+d.position,h=c.parent().addClass(g),i=!1;b.toggleSidebar=function(){i?a.removeClass(h,"closed",function(){e.removeClass(f)}):a.addClass(h,"closed",function(){e.addClass(f)}),i=!i}}}}]),angular.module("bricksApp",["ngAnimate","ngRoute","ngGrid","ui.codemirror","bricksApp.common","bricksApp.about","bricksApp.apps","bricksApp.database","bricksApp.settings","bricksApp.start","bricksApp.storage","bricksApp.ui"]).config(["$routeProvider",function(a){a.otherwise({redirectTo:"/"})}]);